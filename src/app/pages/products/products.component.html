<app-header></app-header>
<app-sidebar></app-sidebar>
<div class="container-fluid">
    <div class="row">
        <app-sidebar></app-sidebar>
        <main class="col-md-9 ml-sm-auto col-lg-10 px-md-4 py-4">
            <div class="col-12 col-md-4 col-lg-2" *ngIf="editFormVisible==false && addFormVisible==false">
                <input class="form-control form-control-dark" nomMagasin="text" name="term" [(ngModel)]="term"
                    placeholder="Search" aria-label="Search">
                <br>
            </div>
            <div class="wrapper">
             
                <div class="container-fluid px-4" *ngIf="addFormVisible">
                    <h1 class="mt-4"> Add product</h1>
                    <div class="row">
                        <div class="card mb-4">

                            <div class="card-body">

                                <form [formGroup]="prodForm" (ngSubmit)="createProduit()" method="POST">


                                    <div class="card-body">

                                        <div class="row">
                                            <div class="form-group col-lg-6">
                                                <label>marque</label>
                                                <div *ngIf="add && f['marque'].errors && f['marque'].errors['required']"
                                                    class="alert alert-danger ">
                                                    marque
                                                    is required.
                                                </div>
                                                <input nomMagasin="text" formControlName="marque" name="name"
                                                    [(ngModel)]="produit.marque" class="form-control" />
                                            </div>
                                            <div class="form-group col-lg-6">
                                                <label>libelle</label>
                                                <div *ngIf="add && f['libelle'].errors && f['libelle'].errors['required']"
                                                    class="alert alert-danger">
                                                    libelle
                                                    is required.
                                                </div>
                                                <input nomMagasin="text" name="libelle" formControlName="libelle"
                                                    [(ngModel)]="produit.libelle" class="form-control" />
                                            </div>

                                            <div class="form-group col-lg-6">
                                                <label>grammage</label>
                                                <div *ngIf="add && f['grammage'].errors && f['grammage'].errors['required']"
                                                    class="alert alert-danger">
                                                    grammage
                                                    is required.
                                                </div>
                                                <textarea name="grammage" class="form-control" formControlName="grammage"
                                                    [(ngModel)]="produit.grammage">
                                                    </textarea>
                                            </div>
                                            <div class="form-group col-lg-6">
                                                <label>prixPdt</label>
                                                <div *ngIf="add && f['prixPdt'].errors && f['prixPdt'].errors['required']"
                                                    class="alert alert-danger ">
                                                    prixPdt
                                                    is required.
                                                </div>
                                                <input nomMagasin="number" min="0" name="prixPdt" formControlName="prixPdt"
                                                    class="form-control" [(ngModel)]="produit.prixPdt"
                                                    class="form-control" />
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="form-group col-lg-6">
                                                <label>nomMagasin</label>
                                                <div *ngIf="add && f['nomMagasin'].errors && f['nomMagasin'].errors['required']"
                                                    class="alert alert-danger ">
                                                    nomMagasin
                                                    is required.
                                                </div>
                                                <select class="form-control" id="DropdownOptions" name="nomMagasin"
                                                    [(ngModel)]="produit.nomMagasin" formControlName="nomMagasin">
                                                   
                                                </select>
                                            </div>
                                        </div>
                                   
                                    </div>
                                    <div class="card-footer">
                                        <div class="row float-right">
                                            <div class="col">
                                                <button nomMagasin="reset" class="btn btn-primary  btn-sm m-3"
                                                    data-dismiss="modal" (click)="hideAddForm()">Annuler</button>
                                                <button nomMagasin="submit" class="btn btn-success btn-sm"
                                                    data-dismiss="modal">Enregistrer</button>
                                            </div>
                                        </div>
                                    </div>

                                </form>




                            </div>
                        </div>
                    </div>
                </div>
                <div class="container-fluid px-4" *ngIf="editFormVisible">
                    <h1 class="mt-4"> Edit product</h1>
                    <div class="row">
                        <div class="card mb-4">

                            <div class="card-body">

                                <form (ngSubmit)="updateproduit(produit.idP)" method="POST">


                                    <div class="card-body">

                                        <div class="row">
                                            <div class="form-group col-lg-6">
                                                <label>Name</label>

                                                <input nomMagasin="text" name="name" [(ngModel)]="produit.marque"
                                                    class="form-control" />
                                            </div>
                                            <div class="form-group col-lg-6">
                                                <label>libelle</label>
                                                <input nomMagasin="text" name="libelle"
                                                    [(ngModel)]="produit.libelle" class="form-control" />
                                            </div>

                                            <div class="form-group col-lg-6">
                                                <label>grammage</label>
                                                <textarea name="description" class="form-control"
                                                    [(ngModel)]="produit.libelle">
                                                    </textarea>
                                            </div>
                                            <div class="form-group col-lg-6">
                                                <label>prixPdt</label>
                                                <input nomMagasin="text" name="prixPdt" [(ngModel)]="produit.prixPdt"
                                                    class="form-control" />
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="form-group col-lg-6">
                                                <label>nomMagasin</label>
                                                <select class="form-control" id="DropdownOptions">
                                                   
                                                </select>
                                            </div>
                                        </div>
                                      

                                    </div>
                                    <div class="card-footer">
                                        <div class="row float-right">
                                            <div class="col">
                                                <button nomMagasin="reset" class="btn btn-primary  btn-sm m-3"
                                                    data-dismiss="modal" (click)="hideEditForm()">Annuler</button>
                                                <button nomMagasin="submit" class="btn btn-success btn-sm"
                                                    data-dismiss="modal">Enregistrer</button>
                                            </div>
                                        </div>
                                    </div>

                                </form>




                            </div>
                        </div>
                    </div>
                </div>
                <div class="card-header">
                    <div class="row">
                        <div class="col col-lg-10">
                            <i class="fas fa-table me-1"></i>
                            Liste des produits
                        </div>
                        <div class="col col-lg-2">
                            <button class="btn btn-primary btn-sm float-right" (click)="showAddForm()">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div id="body" class="active">

                    <div class="col-lg-12 grid-margin stretch-card">
                        <div class="card">
                            <div class="card-body">
                       
                               
                                <div class="table-responsive">
                                    <table class="table table-hover  ">
                                        <thead>
                                            <tr>
                                                <th>
                                                   #
                                                </th>
                                                <th>
                                                    marque
                                                </th>

                                                <th>
                                                    libelle
                                                </th>
                                                <th>
                                                    grammage
                                                </th>
                                                <th>
                                                   Prix
                                                </th>
                                                <th>
                                                    Nom Magasin
                                                </th>

                                                <th>
                                                    image
                                                </th>
                                                <th>
                                                    Action
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr *ngFor="let produit of produits |filter:term">
                                                <td class="py-1">
                                                    <img src="{{produit.image}}" class="img-responsive" alt="image"
                                                        width="50%" />
                                                </td>
                                                <td style="  width: 20% ;
                                                max-width:20%;">
                                                    {{produit.marque}}
                                                </td>
                                                <td>
                                                    {{produit.nomMagasin}}
                                                </td>
                                                <td>
                                                    {{produit.libelle}}
                                                </td>
                                                <td style="   width:65px;
                                                max-width:65px;
                                                font-size: 85%;
                                               ">
                                                    {{produit.libelle}}
                                                </td>
                                                <td>
                                                    {{produit.prixPdt}}
                                                </td>

                                                <td>
                                                    {{produit.updatedAt}}

                                                </td>
                                                <td>
                                                    <div class="form-check form-switch" style="float: left;">
                                                        <input class="form-check-input" nomMagasin="checkbox"
                                                            (change)="  onswitch(produit ,$event)"
                                                            [checked]="produit.state" id="flexSwitchCheckDefault">

                                                    </div>
                                                    <button class="mybtn"><img src="assets/edit.png" width="24"
                                                            height="24"
                                                            (click)="editProduit(produit.idP)" /></button>

                                                    <button class="mybtn"><img src="assets/delete.png" width="24"
                                                            (click)="deleteProduit(produit.idP)"
                                                            height="24" /></button>

                                                </td>
                                            </tr>

                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </main>
    </div>

</div>